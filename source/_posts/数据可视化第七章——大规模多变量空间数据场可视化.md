title: 数据可视化第七章——大规模多变量空间数据场可视化
tags: []
categories:
  - 数据可视化
date: 2019-08-24 11:03:00
author:
---
#### 7.1 大规模空间标量场数据的实时体可视化
大规模标量场数据的快速可视化方法可以分为三个层次:硬件加速、信号处理与特征表达。其中，硬件加速包括使用图形硬件的加速功能、采用并行计算、引入绘制流水线，以及构建分布式多 GPU 架构；信号处理涉及绘制算法优化、多分辨率显示与数据压缩；特征表达则包括保特征压缩、图示与聚类等。<!--more--> 
##### 7.1.1 大规模空间标量场数据的单机绘制
大规模数据的单机绘制方法可以分为三类：硬件加速、数据压缩（含多分辨率显示）和外存计算。硬件加速是指基于图形硬件的快速绘制算法。  
数据压缩是解决大规模空间数据处理的主要思路。针对标量场数据的多分辨率绘制
框架将标量场数据投影到小波基函数张成的空间（即计算小波系数），可获得不同分辨率下的绘制结果。细节层次（level of detail）的方法和基于视点的数据压缩优化可用于数据的自适应存取。将 LBG（Linde Buzo Gray）算法应用于标量场数据压缩，并分析原数据的多分辨相关性，进行层次化的矢量化，可大幅度减小显存的占用。Lindstrom 等人提出了一种对浮点格式数据进行快速压缩的算法，该方
法能够与应用程序的 I/O 环节无缝连接且适用于可变精度的浮点或整型数据。压缩后的可视化质量可采用合适的图像质量度量标准。  
对于无法存储于内存和显存的数据集，可采用外存计算（out of core）处理大规模数据。细节层次技术是适用于不规则标量场数据可视化的外存计算方法。[Gobbetti2008]提出了一种只需遍历数据一次的光线投射外存计算方法。
##### 7.1.2 大规模空间标量场数据的并行绘制
##### 7.1.3 大规模空间标量场数据加速绘制方法
#### 7.2 时变异构空间数据场的特征追踪与可视化
##### 7.2.1 时变异构空间数据场数据的特征提取
##### 7.2.2 异构数据的特征融合
##### 7.2.3 时变空间标量场数据的特征追踪
#### 7.3 空间向量场数据可视化
##### 7.3.1 图标法
##### 7.3.2 几何法
几何法指采用不同类型的几何元素,例如线（curve）、面（surface）和体（volume）模拟向量场的特征。不同类型的几何元素和方法适用于不同特征（稳定、时变）和维度（二维、三维）的向量场。
###### 7.3.2.1 基于曲线的可视化
基于曲线的可视化方法包括两类：一类方法面向稳定向量场，如流线（stream line）；另一类方法面向不稳定/时变向量场，如迹线（path line）和脉线（streak line）。
+ 流线
+ 迹线
+ 脉线


###### 7.3.2.2 基于曲面的可视化
###### 7.3.2.3 基于体的可视化
##### 7.3.3 纹理法
###### 7.3.3.1 点噪声
###### 7.3.3.2 线积分卷积
###### 7.3.3.3 纹理平流
##### 7.3.4 拓扑法
#### 7.4 空间张量场数据可视化
##### 7.4.1 张量场的数学描述
张量是一个定义在向量空间和对偶空间的笛卡尔积上的多线性函数，其坐标是 *n* 维空间，有 *nr* 个分量,其中每个分量都是坐标的函数。在坐标变换时，这些分量也依照某些规则做线性变换。*r* 称为该张量的秩或阶（与矩阵的秩和阶均无关系）。  
在数学里，张量是一种几何实体，或者说广义上的数量。张量可以用坐标系统来表达，记作标量的数组，但它被定义为不依赖于参照系的选择。简而言之，向量可以视为从点到点变化的量，而张量则可被视为从向量到向量变化的量。
在同构的意义下,第 0 阶张量（*r* = 0）为标量，第一阶张量（*r* = 1）为向量,第二阶张量（*r* = 2）则为矩阵。例如，三维空间 *r* = 1 时的张量为一个向量：$(x,y,z)^{T}$。故此,张量可以表述为一个值的序列：用一个向量值的定义域和一个标量值的值域的函数表示。这些定义域中的向量是自然数的向量，而这些数字称为指标。例如，三阶张量可以有尺寸 3、6 和 8。这里，指标的范围是从<1,1,1>到<3,6,8>。张量可以在指标为<1,1,1>有一个值，在指标为<1,1,2>有另一个值……共 144 个值。类似地，向量可以表示为一个值的序列，用一个标量值的定义域和一个标量值的值域的函数表示，定义域中的数字是自然数，称为指标，不同指标的个数有时称为向量的维度。  
应用物理与计算数学中产生的张量场通常是对称或反对称的，数学上意味着张量的矩阵形式是对称或反对称的。
+ **二阶对称张量场实例**  
在医学上，弥散（diffusion）指分子的随机不规则运动，是体内的物质运转方式之一，又称布朗运动（brownian motion）。弥散是一个物理过程，其原始动力为分子所具有的热能。弥散是一个三维过程，分子沿空间某一方向弥散的距离相等或不相等，可以将弥散的方式分为两种：一种是指在完全均匀的介质中，分子的运动由于没有障碍，向各个方向运动的概率相同，称为各向同性（isotropic）弥散。例如，在纯水中水分子的弥散、在脑脊液及大脑灰质中水分子的弥散近似各向同性弥散。另一种弥散具有方向依赖性，在按一定方向排列的组织中，分子向各个方向弥散的概率不相同，则称为各向异性（anisotropIc）弥散。  
通过磁共振弥散加权成像方法获得的原始数据称为 DWI（Diffusion Weighted Image，弥散加权成像）。组织内水分子弥散运动越强，在 DWI 上表现为低信号，相反弥散运动越弱,在 DWI 上表现为高信号。然而，DWI 只能描述单一磁场作用方向上的弥散运动强度。为此,在不同方向的 DWI 基础上可以重建出各向异性数据分布，并简化每个数据分布为一个二阶张量，用来描述水分子沿不同方向扩散的综合运动。二阶张量可用一个正定矩阵表示：$ \pmb D = \begin{bmatrix}
{D_{xx}}&{D_{xy}}&{D_{xz}}\\
{D_{xy}}&{D_{yy}}&{D_{yz}}\\
{D_{xz}}&{D_{yz}}&{D_{zz}}\\
\end{bmatrix}$。不难看出，张量 $ \pmb D$ 是三维空间中的二阶张量，其指标尺寸分别是 3 和 3。  
通过对二阶对称张量 $\pmb D$ 进行特征分解，可得到其特征值及所对应的特征向量。进而，张量可重新表示为：$\pmb D = \gamma\Lambda\gamma^{-1}$，其中，$\Lambda = (e_{1},e_{2},e_{3})^{T}$，$e_{i}$ 表示 $\pmb D$ 的特征向量，$ \Lambda = \begin{bmatrix}
{\lambda_{1}}&{0}&{0}\\
{0}&{\lambda_{2}}&{0}\\
{0}&{0}&{\lambda_{3}}\\
\end{bmatrix}$，\lambda_{i} 是矩阵 $ \pmb D$ 的特征值。$e_{i}$ 指明了扩散方向，\lambda_{i} 则解释了扩散强度。可以视为一个单位旋转矩阵，它决定了张量在张量场中的变换等。
根据特征值之间的关系可将张量分为以下几类，如图 7.28 所示。
+ $\lambda_{1}\gt\gt\lambda_{2}\gt\lambda_{3}$，表示水分子主要沿 $\lambda_{1}$ 扩散，表现为线形模型，记为 $\pmb D_{l}$ 
+ $\lambda_{1}\approx\lambda_{2}\gt\gt\lambda_{3}$，表示水分子主要在 $e_{1}$、$e_{2}$ 所定义的平面内扩散，呈现扁平状，记为 $\pmb D_{p}$ 
+ $\lambda_{1}\approx\lambda_{2}\approx\lambda_{3}$，表示各项同性扩散，此时张量表现为球形，记为 $\pmb D_{s}$
为了定制刻画弥散张量的特征，






##### 7.4.2 基于几何的方法
###### 7.4.2.1 图标法
###### 7.4.2.2 纤维追踪法
##### 7.4.3 基于纹理的方法
###### 7.4.3.1 直接体可视化
###### 7.4.3.2 线积分卷积
###### 7.4.3.3 基于噪声纹理的方法
##### 7.4.4 基于拓扑的方法
###### 7.4.4.1 张量不变量法
###### 7.4.4.2 拉格朗日分析法
##### 7.4.5 高阶张量场可视化
###### 7.4.5.1 图标法
###### 7.4.5.2 纤维追踪法
###### 7.4.5.3 纹理法
#### 7.5 多变量空间数据场可视化
##### 7.5.1 多变量空间数据场的数据分析与表达
多变量数据场可视化的基本手段是采用数据分析和特征抽取方法，获得多变量数据场的内部几何信息、统计特征或信息学特征，并结合投影变换和降维去噪去除冗余信息，减少数据量。本节从特征抽取和统计分析、数据投影变换和降维去噪两个方面展开论述。  
多变量空间数据场数据分析和表达的主要任务是构建和处理多变量数据场的数据结构（几何、拓扑、网格结构等）,提取可视化以及可视表达的对象，即数据属性和衍生特征、相互之间的关系以及变化趋势等。特征指数据场中包含重要信息的相关结构、现象和区域。如体数据的物质边界（标量场特征）、临界点与分离线、面（向量场特征）和退化点（张量场特征）等。多变量数据场的特征相对抽象和复杂，变量间的相似性和差异性等关系不明显。特征抽取指通过构建几何的、拓扑的、图像的各种表达方式计算特征。在实际应用中，特征常依赖于特定的应用领域以及用户需求，没有普适的、统一的定义和描述，甚至是未知的。  
在多变量空间数据场可视化中，特征抽取和统计分析经常被结合使用：将处理对象从原始数据空间变换到统计空间（直方图、散点图等），用统计学方法表达原始数据或者抽取的特征，以达到减少数据量，同时保持关键信息、分析变量间关系的目的。统计分析一般有两种用途，其一是将处理对象从数据空间变换到统计空间（构建统计直方图）以辅助用户完成多变量数据的分类过程；其二是应用统计分析进行特征抽取以及降维去噪。两者往往互相结合。例如，采用单变量数据分析方法，计算梯度和曲率等信息（见第 5 章）。Kniss 和 Hansen 设计了一个适用于多变量可视化的多维传输函数，使用梯度等衍生信息构建多维直方图，随后将该方法应用于一个多变量气象数据实例，Kniss 等人进一步提出了一种直接适用于复杂的多变量数据的高斯传输函数。  

除了上述传统的方式，基于图像处理、物理学特征和拓扑逻辑分析的相关方法教广泛应用于流体可视化和向量场特征抽取。 Janicke 等人基于信息理论，扩展了局部统计复杂性的概念对多变量数据场进行局部复杂性计算，突出了数据场内的重要区域，并在流场和气象数据的实例应用中验证了效果。 Sauber 等人提出了相关场的概念，使用梯度相似性度量（Gradient Similarity Measure，GSIM）和局部相关性因子(Local Correlation Coefficient，LCC）测量和计算多标量场数据各个属性之间的相关性(见图 7.52），并设计了多场图( multifield-graphs）用于选择重要的感兴趣的相关场,避免无谓的计算。  

另外，也有大量工作侧重于数据降维、数据压缩和投影变换等方面。自组织映射（Self-Organizing Map）、多维标度（MDS）、主元分析（PCA）、等距特征映射（Isomap）和快速映射（Fastmap）是多变量可视化领域应用较多的降维方法，能够使数据集中的主要信息得以保留，突出主要特征，最大限度地去除冗余信息和数据量。Konig 总结了 2000 年以前降维和投影变换，以及特征抽取在多变量可视化方面的应用。Guo 等人将基于多维标度的维度投影与平行坐标相结合，有助于凸显用户感兴趣的区域和特征，帮助分析和对比多维数据间的关联。Fout 等人从数据压缩的角度，使用向量量化方法的变种，依据变量之间的相关性，直接对多变量数据进行编码和解码，实现边解码边绘制，并且在解码过程中构建数据的梯度场用于光照计算。可见，对应于特定的应用，必须根据数据自身特点为其选择和设计适用的特征抽取方法和可视表达方式，这将直接影响最终的成像质量，进一步影响用户的感知和理解。
##### 7.5.2 多变量空间数据场的可视化与交互
多变量空间数据场的可视化主要指基于图形学技术，对多变量数据的绘制着色和最终成像过程。交互则指便于用户对数据进行观察和分析的一系列操作，贯穿整个可视化进程。下面将分别进行讨论。
###### 7.5.2.1 视觉通道与融合
多变量空间数据场可视化的手段分为两类：用不同的视觉通道映射和编码各个属性及其相互之间的关系和关联；分别可视化各个数据场的数据属性，再进行融合。两者都可以归结为将数据属性和特征映射到不同的视觉通道（图标信息、纹理信息、颜色和透明度、轮廓、形状、隐喻等），再以合理的方式进行结合，如数据处理阶段的数据融合、绘制阶段的混合绘制、图像处理阶段的图像融合等。下面围绕视觉通道和图像融合、数据融合和混合绘制两个主题进行论述。  
图标信息和纹理信息作为强大的、可携带和编码丰富信息的表达载体，在多变量可视化技术中最为常见。图标法可清晰地编码多个变量属性，尤其是可表达方向信息，因此图标法被广泛用于向量场和张量场可视化。另一种途径是使用纹理。Ware 和 Knight 认为人类可以感知的与纹理有关的三个视觉通道是模式、大小和方向。研究表明，人类视觉系统对于纹理的上述三个视觉元素的感知和颜色一样，属于一种底层的视觉感受，可以被迅速而精确地感知到。 Interrante 使用自然纹理来可视化多变量数据场，认为自然纹理可编码大量信息并且信息集中紧凑，对于视觉系统的压力较小。Tang 等人则使用自然纹理的特征编码多变量气象数据的不同属性，并结合多层次的纹理合成技术实现最终的可视化。相反, Laidlaw 认为结合人类艺术创造的过程，分析艺术家不同笔触所包含的信息，可以利用艺术化的人工纹理支持多变量场的可视化。结合颜色和纹理进行多变量数据可视化也是常用的方法。Taylor 设计了一个用于在同一表面上可视化多个数据场层次的系统，并且研究了传统层次混合方法的局限性，即由于层次之间的遮挡和视觉混乱，使用带透明度的颜色混合最多只能处理 4 个层次。 Urness 等人提出了色织（color weaving）的概念，克服了传统颜色混合的缺点，可以处理任意数目的颜色重叠（见图 7.53（a）），强化了颜色编码和纹理的混合应用。  

数据融合和混合绘制是多变量可视化的另一个重要研究方向。 Kreeger 等人和 Rössler 等人研究了绘制阶段的混合技术。典型的图像处理阶段的混合技术可见 Wong 等人（见图 7.53（b））对多变量气象数据可视化的研究结果。此外，也有针用对不同数据类型和属性采用不同绘制风格进行混合绘制的研究。Stompel 等人使用表意性和非真实感绘制的手法，将某些变量编码成视觉元素，凸显其他变量所表达的特征。  
基于数据融合和混合绘制的多变量可视化方法直接处理数据属性，可以有机结合统计分析以及特征抽取等数据处理手段进行可视分析，因而研究手段更加丰富。尽管可以使用单一的可视化技术直接对多变量数据场进行可视化（见图 7.53（c）），但是多变量空间数据场自身的特点决定了多变量数据可视化作为一种广义的混合绘制的必然性，尤其在分析真正复杂的混合数据场多变量数据时，标量场数据之间的混合绘制（包括体绘制与面绘制的混合），标量场数据与向量场、张量场的混合绘制，多种视觉通道的混合应用，不同绘制风格的混合绘制，以及图像处理阶段的层次和图像融合。由于各种绘制技术和视觉通道之间往往互相影响，因此应当依据特定的应用和数据场自身特点，将对应的可视化技术进行组合,在降低多变量多数据场所带来的信息和视觉混乱以及相互之间遮挡的前提下，尽量同时展示所有变量中包含的信息，避免部分示带来的数据理解偏差和误导。
###### 7.5.2.2 交互探索
多变量可视化领域的交互基本上已经形成了以多关联视图为基础、二维视图用于显示和分析属性关系、三维视图用于显示物理数据空间、使用高维传输函数和画刷及其衍生技术为特征选取技术、以焦点 + 上下文或其变种为数据和特征显示方法的基本框架。表 7.2 总结了已有的多变量空间数据场的交互技术。  
由表 7.2 中的结果可知，多关联视图是多变量可视化交互的基础和重要的手段，在分场变量之间的相互关系以及建立数据空间和各种抽象空间的联系方面，有着无可替代的作用。近年来多变量数据越来越复杂，数据分析越来越抽象，研究重心逐断偏向于对数据属性之间的关系和变化趋势的分析。从方法来看,无论是特征选取还是数据属性和关联分析，基于统计分析和机器学习的交互方法在近年的研究工作中所占的比重越来越大并且成为主流。


